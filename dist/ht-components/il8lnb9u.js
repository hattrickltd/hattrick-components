/*! Built with http://stenciljs.com */
const{h:t}=window.HtComponents;import{a as e}from"./chunk-b197b654.js";var i,s=function(t,e,i,s){return new(i||(i=Promise))(function(l,a){function h(t){try{o(s.next(t))}catch(t){a(t)}}function n(t){try{o(s.throw(t))}catch(t){a(t)}}function o(t){t.done?l(t.value):new i(function(e){e(t.value)}).then(h,n)}o((s=s.apply(t,e||[])).next())})};class l extends e{constructor(){super(...arguments),this.max=20,this.cap=0,this.isCap=!1,this.label="",this.denomination="",this.hideContent=!1,this.lazy=!0,this.levelText="",this.showSkillInColumn=i.Max,this.labelTextWidth=0,this.levelTextWidth=0,this.forceLevelTextPosition=!1,this.didLoad=!1}get totalWidth(){return this.host.clientWidth}componentWillLoad(){const t=t=>super[t];return s(this,void 0,void 0,function*(){this._hostStyle=window.getComputedStyle(this.host,null),(yield this.lazy)?t("lazyLoad").call(this,this.host):Promise.resolve(),this.didLoad=!0,this.setCalculations(!1)})}componentDidLoad(){this.didLoad&&this.setCalculations()}componentWillUpdate(){this.didLoad&&this.setCalculations()}setCalculations(t=!0){this.skillWidth=this.getSkillWidth(),this.capWidth=this.getCapWidth(),this.hideContent||(this.levelText=this.getLevelText(),this.labelTextWidth=a(this.label,this._hostStyle.font),this.levelTextWidth=a(this.levelText,this._hostStyle.font),t&&(this.denomination?(this.forceLevelTextPosition=!1,this.showSkillInColumn=i.None):this.doesLevelTextFitInMaxColumn()?(this.forceLevelTextPosition=!1,this.showSkillInColumn=i.Max):this.doesLevelTextFitInCapColumn()?(this.forceLevelTextPosition=!1,this.showSkillInColumn=i.Cap):this.doesLevelTextFitInLevelColumn()?(this.forceLevelTextPosition=!1,this.showSkillInColumn=i.Level):(this.forceLevelTextPosition=!0,this.hasMaxBar()?this.showSkillInColumn=i.Max:this.hasCapBar()?this.showSkillInColumn=i.Cap:this.showSkillInColumn=i.Level))),this.numberPadding=this.getNumberPadding()}percentageToPixels(t){return t>1&&(t/=100),this.totalWidth*t}getSkillWidth(){return this.level<=0?0:this.level>this.max?100:this.level/this.max*100}getCapWidth(){return this.hasCapBar()?this.cap/this.max*100-this.skillWidth:0}getNumberPadding(){let t=this.labelTextWidth,e=0,i=this.percentageToPixels(this.skillWidth+this.capWidth);return i<t&&(e=t-i+5),e}getLevelText(){return this.cap>0?`${this.getSkillNumberText(this.level)} / ${this.cap}`:this.getSkillNumberText(this.level)}getSkillNumberText(t){return t<0?"-":t>this.max?`${this.max} (+${t-this.max})`:t.toString()}hasCapBar(){return this.cap>0&&this.cap!==this.level}hasMaxBar(){return this.level<this.max&&this.cap<this.max}doesLevelTextFitInMaxColumn(){const t=this.percentageToPixels(100-this.capWidth-this.skillWidth);return this.levelTextWidth+10<t}doesLevelTextFitInCapColumn(){let t=this.percentageToPixels(this.capWidth),e=this.levelTextWidth+10,i=this.labelTextWidth-this.percentageToPixels(this.capWidth);return i>0&&(t-=i),e<t}doesLevelTextFitInLevelColumn(){let t=this.percentageToPixels(this.levelTextWidth),e=this.levelTextWidth+10,i=this.labelTextWidth-this.percentageToPixels(this.skillWidth);return i>0&&(t-=i),e<t}getPadding(){return"ltr"===(this._hostStyle.direction||"ltr")?{"padding-left":this.numberPadding+"px"}:{"padding-right":this.numberPadding+"px"}}hostData(){return{"aria-label":this.label+": "+(this.denomination||`${this.level} / ${this.cap||this.max}`)}}render(){return this.didLoad?t("table",{class:{"level-text-dont-fit":this.forceLevelTextPosition,"has-cap-bar":this.hasCapBar()}},t("tr",null,t("td",{class:{"bar-level":!0,maxed:this.isCap},style:{width:this.skillWidth+"%"}},t("span",{class:"title"},this.label),this.denomination&&t("span",{class:"denomination"},this.denomination),this.showSkillInColumn===i.Level&&t("span",{class:"number"},this.levelText)),this.hasCapBar()&&t("td",{class:"bar-cap",style:{width:this.capWidth+"%"}},this.showSkillInColumn===i.Cap&&t("span",{class:"number"},this.levelText)),this.hasMaxBar()&&t("td",{class:"bar-max",style:this.getPadding()},this.showSkillInColumn===i.Max&&t("span",{class:"number"},this.levelText)))):t("table",null)}static get is(){return"ht-bar"}static get encapsulation(){return"shadow"}static get properties(){return{cap:{type:Number,attr:"cap"},capWidth:{state:!0},denomination:{type:String,attr:"denomination",reflectToAttr:!0},didLoad:{state:!0},forceLevelTextPosition:{state:!0},hideContent:{type:Boolean,attr:"hide-content"},host:{elementRef:!0},isCap:{type:Boolean,attr:"is-cap"},label:{type:String,attr:"label"},labelTextWidth:{state:!0},lazy:{type:Boolean,attr:"lazy"},level:{type:Number,attr:"level"},levelText:{state:!0},levelTextWidth:{state:!0},max:{type:Number,attr:"max"},numberPadding:{state:!0},showSkillInColumn:{state:!0},skillWidth:{state:!0}}}static get style(){return":host{position:relative;display:block;font-size:1em;line-height:1em}table{table-layout:fixed;width:100%;border-spacing:0;overflow:hidden}td{height:calc(1em + .25em);padding:1px;vertical-align:middle}td.bar-level{background-color:var(--bar-level-background,#a9a9a9);color:var(--bar-max-background,#ececec);position:relative;text-align:start}td.bar-level.maxed{background-color:var(--bar-capped-background,#ffeb99);color:var(--bar-level-background,#a9a9a9)}td.bar-cap{background-color:var(--bar-cap-background,#cacaca);color:var(--bar-max-background,#ececec);text-align:start}td.bar-max{background-color:var(--bar-max-background,#ececec);color:var(--bar-level-background,#a9a9a9)}.title{color:var(--bar-title-color,#000);white-space:nowrap;position:absolute;top:2px}:host([denomination]) .title{width:80px;overflow:hidden}:host-context([dir=ltr]) .title{left:2px}:host-context([dir=rtl]) .title{right:2px}.number{display:inline-block;margin-left:5px;margin-right:5px;white-space:nowrap}td.bar-level .number{position:absolute;top:2px}:host-context([dir=ltr]) td.bar-level .number{right:0}:host-context([dir=rtl]) td.bar-level .number{left:0}.level-text-dont-fit .bar-cap{color:var(--bar-max-background,#ececec)}.level-text-dont-fit .bar-max{color:var(--bar-cap-background,#cacaca)}.level-text-dont-fit.has-cap-bar.bar-max{color:var(--bar-level-background,#a9a9a9)}.level-text-dont-fit .number{position:absolute;top:2px}:host-context([dir=ltr]) .level-text-dont-fit .number{right:0}:host-context([dir=rtl]) .level-text-dont-fit .number{left:0}.denomination{position:absolute;color:var(--bar-denomination-color,#000);white-space:nowrap;top:2px}:host-context([dir=ltr]) .denomination{left:85px}:host-context([dir=rtl]) .denomination{right:85px}"}}function a(t,e){const i=a,s=(i.canvas||(i.canvas=document.createElement("canvas"))).getContext("2d");return s.font=e,s.measureText(t).width}!function(t){t[t.None=-1]="None",t[t.Level=0]="Level",t[t.Cap=1]="Cap",t[t.Max=2]="Max"}(i||(i={}));export{l as HtBar};